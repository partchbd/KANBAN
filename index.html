<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mini Kanban App</title>
  <style>
    body { font-family: Arial, sans-serif; margin:0; background:#f0f0f3; color:#333; }

    /* ¡IMPORTANTE! Las pantallas inician ocultas */
    .screen { display:none; }
    /* La clase 'active' la activa JavaScript */
    .screen.active { display:block; }

    h1 { text-align:center; padding:20px 0; margin:0; font-weight:normal; color:#444; }

    .container, .screen:not(#kanbanBoardScreen) {
      max-width:420px;
      margin:40px auto;
      background:#ffffff;
      padding:25px;
      border-radius:12px;
      box-shadow:0 4px 12px rgba(0,0,0,0.08);
      border:1px solid #ddd;
    }
    
    #kanbanBoardScreen {
        margin:0;
        padding:0;
        max-width:none;
        width:100vw;
        height:100vh;
        overflow:auto;
        background-color: #f7f7f7; /* Fondo base para el tablero */
    }

    h2{text-align:center; font-weight:normal; color:#555;} 
    h3 {margin-top:20px; font-weight:normal; color:#555;}

    input[type="text"], input[type="password"], textarea, select{
      width:100%;
      padding:10px;
      margin:12px 0;
      border:1px solid #ccc;
      border-radius:8px;
      background:#f9f9f9;
      font-size:15px;
      box-sizing: border-box;
    }
    
    /* Estilos para el formulario de crear tarea (similar a la imagen 5) */
    .task-form-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        display: none;
        justify-content: center;
        align-items: flex-start;
        z-index: 100;
        padding-top: 50px;
    }
    .task-form-overlay.active { display: flex; }
    
    .task-form-content {
        width: 90%;
        max-width: 600px;
        background-color: #ffffdd; /* Fondo amarillo/claro de la referencia */
        border-radius: 8px;
        padding: 20px;
        box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    }
    .task-form-content select, .task-form-content input[type="date"] {
        margin-right: 10px;
        width: auto;
    }
    .task-form-content .header, .task-form-content .footer {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
    }
    .task-form-content .footer button {
        width: auto;
        margin-right: 10px;
    }
    .close-btn {
        background: none;
        border: none;
        color: #333;
        font-size: 20px;
        cursor: pointer;
        width: auto;
        padding: 5px;
    }
    .task-form-content label { display: block; margin-top: 10px; }


    button{
      width:100%;
      padding:12px;
      background:#8aa8c9;
      border:none;
      color:white;
      font-size:16px;
      border-radius:8px;
      cursor:pointer;
      transition:0.2s;
      margin: 5px 0;
    }

    button:hover{ background:#6f8fb3; }
    
    .btn-secondary { background: #bbb; }
    .btn-secondary:hover { background: #999; }
    
    .btn-group { display: flex; justify-content: space-between; gap: 10px; }
    .btn-group button { width: 50%; }

    a { color:#6f8fb3; text-decoration:none; }
    a:hover { text-decoration:underline; }

    /* Estilos para las opciones de ejemplo (como en las imágenes de flujo/tipos) */
    .option-tag {
        display: inline-block;
        padding: 5px 10px;
        margin: 5px;
        border: 1px solid #ccc;
        border-radius: 20px;
        font-size: 14px;
        background: #f0f0f0;
        cursor: default;
    }

    /* Estilos del Tablero Kanban (simulación de Screenshot_20251127-120645.jpg) */
    .kanban-board-header {
        background-color: #fff;
        padding: 10px 20px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        display: flex;
        align-items: center;
        justify-content: space-between;
    }
    .kanban-columns {
        display: flex;
        padding: 20px;
        gap: 15px;
        overflow-x: auto;
    }
    .kanban-column {
        min-width: 250px;
        background-color: #f7f7f7;
        border-radius: 8px;
        padding: 10px;
    }
    .kanban-column h3 {
        text-align: center;
        background-color: #ffdd00; /* Color de columna de la imagen */
        padding: 10px 0;
        margin-top: 0;
        margin-bottom: 10px;
        border-radius: 4px;
        font-size: 16px;
        font-weight: bold;
    }
    .kanban-card {
        background-color: #fff;
        padding: 10px;
        margin-bottom: 8px;
        border-radius: 6px;
        box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        border-left: 5px solid yellow; /* Simulación de color de tarjeta estándar */
    }
    .kanban-card.urgent { border-left-color: red; } /* Simulación de tarjeta urgente */

    /* Estilos para seleccionar fondo (Screenshot_20251127-120600.png) */
    .background-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 10px;
        margin-top: 20px;
    }
    .background-option {
        height: 100px;
        border: 2px solid #ddd;
        border-radius: 8px;
        cursor: pointer;
        background-size: cover;
        background-position: center;
        opacity: 0.7;
        transition: all 0.2s;
    }
    .background-option.selected {
        border-color: #8aa8c9;
        border-width: 4px;
        opacity: 1;
    }
    .bg-white { background-color: white; }
    /* Nota: He mantenido los placeholders para las imágenes de fondo. */
    .bg-lake { background-color: #a0c2d7; }
    .bg-tree { background-color: #798679; }
    .bg-mac { background-color: #f0f0f0; } 
    .bg-forest { background-color: #333; } 
  </style>
</head>
<body>
  <h1>Mini Kanban</h1>

  <div id="registerScreen" class="screen">
    <h2>Registrarse</h2>
    <input id="regUser" placeholder="Usuario" /><br />
    <input id="regPass" type="password" placeholder="Contraseña" /><br />
    <button onclick="register()">Crear cuenta</button>
    <p>¿Ya tienes cuenta? <a href="#" onclick="showScreen('loginScreen')">Inicia sesión</a></p>
  </div>

  <div id="loginScreen" class="screen">
    <h2>Iniciar sesión</h2>
    <input id="logUser" placeholder="Usuario" /><br />
    <input id="logPass" type="password" placeholder="Contraseña" /><br />
    <button onclick="login()">Entrar</button>
  </div>

  <div id="dashboardScreen" class="screen">
    <h2>Bienvenido</h2>
    <p>Elige cómo quieres crear tu tablero:</p>
    <button onclick="startBoardCreation('solo')">Crear tablero solo</button><br />
    <button onclick="startBoardCreation('grupo')">Crear tablero en grupo</button>
  </div>

  <div id="nameBoardScreen" class="screen">
    <h2>Cree un nuevo tablero</h2>
    <h3>Empiece dándole un nombre a su nuevo tablero</h3>
    <p>Ingrese el nombre del nuevo tablero</p>
    <input id="boardName" type="text" placeholder="Nombre del proceso o proyecto" />
    <label><input type="checkbox" /> Usa el Asistente AI para ayudarme a construir el tablero. BETA</label>
    <button onclick="nextStep('workflowScreen', 'nameBoardScreen', 'boardName')">Siguiente</button>
  </div>

  <div id="workflowScreen" class="screen">
    <h2>Cree un nuevo tablero</h2>
    <h3>¿Cuál es el flujo de trabajo de <span id="boardNameDisplay1">Yyy</span>?</h3>
    <p>Piense en el proceso que desea visualizar en su tablero. ¿Cuál es la secuencia de pasos que deben seguir los elementos de trabajo desde el inicio hasta el final? Escriba cada uno de ellos en el formulario de la izquierda; estos se convertirán en las **columnas** del tablero.</p>

    <input type="text" id="step1" value="Por hacer" placeholder="1. Paso" />
    <input type="text" id="step2" value="En Progreso" placeholder="2. Paso" />
    <input type="text" id="step3" value="Completado" placeholder="3. Paso" />
    <input type="text" id="step4" placeholder="4. Paso (opcional)" />
    
    <p>Estos son algunos ejemplos:</p>
    <div style="text-align: center;">
        <span class="option-tag">básico</span>
        <span class="option-tag">impulsado por el tiempo</span>
        <span class="option-tag">desarrollo de productos</span>
    </div>

    <button onclick="nextStep('workTypeScreen', 'workflowScreen', 'workflow')">Siguiente</button>
    <button class="btn-secondary" onclick="prevStep('nameBoardScreen')">Atrás</button>
  </div>

  <div id="workTypeScreen" class="screen">
    <h2>Cree un nuevo tablero</h2>
    <h3>¿Qué tipos de elementos de trabajo aparecen en <span id="boardNameDisplay2">Yyy</span>?</h3>
    <p>Decida con cuáles elementos trabaja habitualmente. Por ejemplo: peticiones de clientes, reportes de problemas, etc. Introduzca en el formulario de la izquierda y asigne una tarjeta de colores diferentes a cada uno. Estos colores le ayudarán a distinguir cuáles tipos de trabajo están en este proceso.</p>

    <input type="text" id="type1" value="Estándar" placeholder="Tipo 1" style="border-left: 5px solid yellow;"/>
    <input type="text" id="type2" value="Trabajo urgente" placeholder="Tipo 2" style="border-left: 5px solid red;"/>
    <input type="text" id="type3" placeholder="Tipo 3 (opcional)" style="border-left: 5px solid lightblue;"/>
    
    <p>Pruebe uno de estos:</p>
    <div style="text-align: center;">
        <span class="option-tag">Trabajo interno</span>
        <span class="option-tag">Cambio operacional</span>
        <span class="option-tag">Nota</span>
    </div>
    
    <div class="btn-group">
        <button class="btn-secondary" onclick="prevStep('workflowScreen')">Atrás</button>
        <button onclick="nextStep('backgroundScreen', 'workTypeScreen', 'workTypes')">Siguiente</button>
        <button onclick="nextStep('kanbanBoardScreen', 'workTypeScreen', 'workTypes')">Finalizar</button>
    </div>
  </div>
  
  <div id="backgroundScreen" class="screen">
    <h2>Cree un nuevo tablero</h2>
    <h3>Seleccione un fondo para su tablero</h3>
    <p>Foto por: Kanban Tool</p>
    
    <div class="background-grid">
        <div class="background-option bg-white selected" data-bg="white" onclick="selectBackground(this)"></div>
        <div class="background-option bg-lake" data-bg="lake" onclick="selectBackground(this)"></div>
        <div class="background-option bg-tree" data-bg="tree" onclick="selectBackground(this)"></div>
        <div class="background-option" style="background-color: #ccc;"></div>
        <div class="background-option bg-mac"></div>
        <div class="background-option bg-forest"></div>
    </div>
    
    <div class="btn-group">
        <button class="btn-secondary" onclick="prevStep('workTypeScreen')">Atrás</button>
        <button onclick="nextStep('kanbanBoardScreen', 'backgroundScreen', 'background')">Finalizar</button>
    </div>
  </div>


  <div id="kanbanBoardScreen" class="screen">
    <div class="kanban-board-header">
        <h2 id="finalBoardName">Tablero Kanban</h2>
        <button style="width: 150px;" onclick="showTaskForm()">+ Nueva Tarea</button>
    </div>
    <div class="kanban-columns" id="kanbanColumns">
        </div>
  </div>

  <div id="taskFormOverlay" class="task-form-overlay">
    <div class="task-form-content">
        <div class="header">
            <input type="text" id="taskNameInput" placeholder="Dar nombre a tarea..." style="width: auto; flex-grow: 1; margin-right: 10px;" />
            <span style="font-size: 14px;">+ lista</span>
            <button class="close-btn" onclick="hideTaskForm()">×</button>
        </div>
        
        <label>Descripción</label>
        <textarea placeholder="Descripción"></textarea>
        
        <label>Adjuntos</label>
        <input type="text" placeholder="Adjuntos..." />

        <div style="display: flex; gap: 10px; margin-top: 15px; flex-wrap: wrap; justify-content: space-between;">
            <div style="flex-grow: 1;">
                <label>Tipo de tarjeta</label>
                <select id="taskType">
                    </select>
            </div>

            <div style="flex-grow: 1;">
                <label>Prioridad</label>
                <select>
                    <option value="normal">normal</option>
                    <option value="alta">alta</option>
                </select>
            </div>

            <div style="flex-grow: 1;">
                <label>Fecha Límite</label>
                <input type="date" style="width: 100px;"/>
            </div>

            <div style="flex-grow: 1;">
                <label>Asignado a</label>
                <select>
                    <option value="nadie">- nadie -</option>
                    <option value="usuario">Usuario</option>
                </select>
            </div>
        </div>

        <div class="footer">
            <div style="display: flex; gap: 10px; margin-top: 20px;">
                <button onclick="alert('Tarea creada y formulario cerrado')" style="background-color: #5cb85c;">Crear y cerrar</button>
                <button onclick="alert('Tarea creada, lista para otra')" style="background-color: #5bc0de;">Crear y añadir nuevo</button>
                <button onclick="alert('Tarea creada, abriendo edición')">Crear y editar</button>
            </div>
            <div>
                <label style="display: inline-flex; align-items: center; margin-left: 20px; font-size: 14px;">
                    <input type="checkbox" style="width: auto; margin: 0 5px 0 0;"/> agregar al principio
                </label>
            </div>
        </div>
    </div>
  </div>

  <script>
    let boardConfig = {
      type: '',
      name: '',
      workflow: [],
      workTypes: [{ name: 'Estándar', color: 'yellow' }, { name: 'Trabajo urgente', color: 'red' }], // Valores por defecto
      background: 'white'
    };

    function showScreen(id) {
      // Función central para cambiar de pantalla
      document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
      const screenElement = document.getElementById(id);
      if (screenElement) {
          screenElement.classList.add('active');
      } else {
          console.error(`Error: Pantalla con ID '${id}' no encontrada.`);
      }
    }

    function register() {
      const u = document.getElementById('regUser').value;
      const p = document.getElementById('regPass').value;
      if (!u || !p) return alert('Llena todos los campos');
      const users = JSON.parse(localStorage.getItem('users') || '{}');
      if (users[u]) {
        alert('El usuario ya existe.');
        return;
      }
      users[u] = p;
      localStorage.setItem('users', JSON.stringify(users));

      alert('Cuenta creada');
      showScreen('loginScreen');
    }

    function login() {
      const u = document.getElementById('logUser').value;
      const p = document.getElementById('logPass').value;
      const users = JSON.parse(localStorage.getItem('users') || '{}');

      if (users[u] === p) {
        localStorage.setItem('session', u);
        showScreen('dashboardScreen');
      } else {
        alert('Datos incorrectos');
      }
    }

    /* --- Flujo de Creación de Tablero --- */
    
    function startBoardCreation(type) {
      boardConfig.type = type;
      showScreen('nameBoardScreen');
    }
    
    function nextStep(nextScreenId, currentScreenId, configKey) {
        if (configKey === 'boardName') {
            const name = document.getElementById('boardName').value.trim();
            if (!name) return alert('Por favor, ingresa un nombre para el tablero.');
            boardConfig.name = name;
            
            document.getElementById('boardNameDisplay1').innerText = name;
            document.getElementById('boardNameDisplay2').innerText = name;
        } else if (configKey === 'workflow') {
            const steps = [];
            for(let i = 1; i <= 4; i++) {
                const step = document.getElementById(`step${i}`).value.trim();
                if (step) steps.push(step);
            }
            if (steps.length < 2) return alert('Por favor, define al menos 2 pasos para el flujo de trabajo.');
            boardConfig.workflow = steps;
        } else if (configKey === 'workTypes') {
            const types = [];
            if(document.getElementById('type1').value.trim()) types.push({ name: document.getElementById('type1').value.trim(), color: 'yellow' });
            if(document.getElementById('type2').value.trim()) types.push({ name: document.getElementById('type2').value.trim(), color: 'red' });
            if(document.getElementById('type3').value.trim()) types.push({ name: document.getElementById('type3').value.trim(), color: 'lightblue' });
            
            if (types.length < 1) return alert('Por favor, define al menos 1 tipo de trabajo.');
            boardConfig.workTypes = types;
        } else if (configKey === 'background') {
            const selectedBg = document.querySelector('.background-option.selected');
            boardConfig.background = selectedBg ? selectedBg.getAttribute('data-bg') : 'white';
        }

        if (nextScreenId === 'kanbanBoardScreen') {
            generateKanbanBoard();
        }
        
        showScreen(nextScreenId);
    }
    
    function prevStep(prevScreenId) {
        showScreen(prevScreenId);
    }

    function selectBackground(element) {
        document.querySelectorAll('.background-option').forEach(el => el.classList.remove('selected'));
        element.classList.add('selected');
    }

    function generateKanbanBoard() {
        const boardScreen = document.getElementById('kanbanBoardScreen');
        const columnsContainer = document.getElementById('kanbanColumns');
        
        // Aplicar fondo (usando solo colores o placeholders simples)
        if (boardConfig.background === 'white') {
            boardScreen.style.backgroundImage = 'none';
            boardScreen.style.backgroundColor = '#f7f7f7';
        } else {
             // Aquí usarías la URL real de la imagen, por ahora solo un color base
            boardScreen.style.backgroundColor = '#ddd';
        }

        document.getElementById('finalBoardName').innerText = boardConfig.name || 'Mi Tablero Kanban';
        
        columnsContainer.innerHTML = '';
        
        // Generar columnas
        boardConfig.workflow.forEach(step => {
            const columnDiv = document.createElement('div');
            columnDiv.className = 'kanban-column';
            
            const columnTitle = document.createElement('h3');
            columnTitle.innerText = step;
            columnDiv.appendChild(columnTitle);
            
            // Simular tarjeta de ejemplo
            const exampleCard = document.createElement('div');
            // Usar el primer tipo de tarjeta definido para el ejemplo
            const cardType = boardConfig.workTypes[0] || { name: 'Estándar', color: 'yellow' }; 
            
            exampleCard.className = 'kanban-card';
            exampleCard.innerHTML = `<strong>Tarea de Ejemplo</strong><br><small>Tipo: ${cardType.name}</small>`;
            exampleCard.style.borderLeftColor = cardType.color;

            if (step === 'En Progreso') {
                columnDiv.appendChild(exampleCard);
            }
            
            columnsContainer.appendChild(columnDiv);
        });
        
        // Actualizar opciones de tipo de tarjeta en el formulario de tarea
        const taskTypeSelect = document.getElementById('taskType');
        taskTypeSelect.innerHTML = '';
        boardConfig.workTypes.forEach(type => {
            const option = document.createElement('option');
            option.value = type.name;
            option.innerText = type.name;
            taskTypeSelect.appendChild(option);
        });
    }

    function showTaskForm() {
        document.getElementById('taskFormOverlay').classList.add('active');
    }

    function hideTaskForm() {
        document.getElementById('taskFormOverlay').classList.remove('active');

  </script>
</body>
</html>



